# 🧮数据库设计

### 1. **用户表（users）**

- **user_id**: INT, 主键，自增
- **username**: VARCHAR(50), 唯一
- **password_hash**: VARCHAR(255) // 存储加密后的密码
- **email**: VARCHAR(100), 唯一
- **phone_number**: VARCHAR(20), 可选
- **address**: TEXT, 可选
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 2. **产品表（products）**

- **product_id**: INT, 主键，自增
- **name**: VARCHAR(100)
- **description**: TEXT
- **price**: DECIMAL(10, 2)
- **stock**: INT // 库存数量
- **image_url**: VARCHAR(255) // 产品图片链接
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 3. **购物车表（cart_items）**

- **cart_item_id**: INT, 主键，自增
- **user_id**: INT, 外键，引用 users.user_id
- **product_id**: INT, 外键，引用 products.product_id
- **quantity**: INT // 商品数量
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 4. **订单表（orders）**

- **order_id**: INT, 主键，自增
- **user_id**: INT, 外键，引用 users.user_id
- **total_amount**: DECIMAL(10, 2) // 订单总金额
- **status**: ENUM('Pending', 'Processing', 'Shipped', 'Delivered', 'Cancelled') // 订单状态
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 5. **订单项表（order_items）**

- **order_item_id**: INT, 主键，自增
- **order_id**: INT, 外键，引用 orders.order_id
- **product_id**: INT, 外键，引用 products.product_id
- **quantity**: INT // 商品数量
- **price**: DECIMAL(10, 2) // 单个商品的价格
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 6. **支付记录表（payments）**

- **payment_id**: INT, 主键，自增
- **order_id**: INT, 外键，引用 orders.order_id
- **amount**: DECIMAL(10, 2) // 支付金额
- **payment_method**: ENUM('WeChat', 'Alipay', 'CreditCard') // 支付方式
- **payment_status**: ENUM('Pending', 'Completed', 'Failed') // 支付状态
- **payment_date**: TIMESTAMP // 支付时间
- **created_at**: TIMESTAMP, 默认当前时间
- **updated_at**: TIMESTAMP, 默认当前时间，更新时自动改变

### 表间关系

- **用户表**（users）与**购物车表**（cart_items）、**订单表**（orders）之间是一对多的关系。
- **产品表**（products）与**购物车表**（cart_items）、**订单项表**（order_items）之间是一对多的关系。
- **订单表**（orders）与**订单项表**（order_items）之间是一对多的关系。
- **订单表**（orders）与**支付记录表**（payments）之间是一对一的关系。

### 设计要点

- **索引**: 在高频查询字段上创建索引，例如 `user_id`、`product_id`、`order_id`。
- **安全性**: 对敏感数据（如密码）进行加密处理。
- **性能优化**: 监控数据库性能，并根据需要调整表结构和索引。

```
+------------------+        +------------------+        +------------------+
|      Users       |        |   Products       |        |   Cart_Items     |
+------------------+        +------------------+        +------------------+
| PK user_id       |        | PK product_id    |        | PK cart_item_id  |
| username         |        | name             |        | FK user_id       |
| password_hash    |        | description      |        | FK product_id    |
| email            |        | price            |        | quantity         |
| phone_number     |        | stock            |        | created_at       |
| address          |        | image_url        |        | updated_at       |
| created_at       |        | created_at       |        +------------------+
| updated_at       |        | updated_at       |
+------------------+        +------------------+
        |                             |
        |                             |
        |                             |
        +                             +
        | 1                         * | 
        |                             |
        v                             v
+------------------+        +------------------+
|    Orders        |        |   Order_Items    |
+------------------+        +------------------+
| PK order_id      |        | PK order_item_id |
| FK user_id       |        | FK order_id      |
| total_amount     |        | FK product_id    |
| status           |        | quantity         |
| created_at       |        | price            |
| updated_at       |        | created_at       |
+------------------+        | updated_at       |
                            +------------------+
                                    |
                                    |
                                    |
                                    |
                                    |
                                    v
                        +------------------+
                        |    Payments      |
                        +------------------+
                        | PK payment_id    |
                        | FK order_id      |
                        | amount           |
                        | payment_method   |
                        | payment_status   |
                        | payment_date     |
                        | created_at       |
                        | updated_at       |
                        +------------------+

```